<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.anylogic.ssystem.bms.com.mapper.ComMenuMapper">

    <resultMap id="selectMenuListMap" type="com.anylogic.ssystem.bms.com.model.SelectMenuListResVO">
        <id column="id" property="id" />                              <!--  -->
        <result column="name" property="name" />                      <!--  -->
        <result column="type" property="type" />                      <!--  -->
        <result column="description" property="description" />        <!--  -->
        <result column="url" property="url" />                        <!--  -->
        <result column="isuse" property="isuse" />                    <!--  -->
        <result column="inid" property="inid" />                        <!--  -->
        <result column="indt" property="indt" />                        <!--  -->
        <result column="upid" property="upid" />                        <!--  -->
        <result column="updt" property="updt" />                        <!--  -->
        <result column="menuorder" property="menuorder" />                        <!--  -->
    </resultMap>

    <resultMap id="selectLeftMenuParentMap" type="com.anylogic.ssystem.bms.com.model.SelectLeftMenuResVO" >
        <result column="parentid" property="parentid"/>
        <result column="parentname" property="parentname"/>
        <result column="parenturl" property="parenturl"/>
        <result column="icon" property="icon"/>
    </resultMap>

    <resultMap id="getMenuDetailBIAMap" type="com.anylogic.ssystem.bms.com.model.GetMenuDetailBIAResVO">
        <id column="id" property="id" />                              <!--  -->
        <result column="name" property="name" />                      <!--  -->
        <result column="type" property="type" />                      <!--  -->
        <result column="description" property="description" />        <!--  -->
        <result column="url" property="url" />                        <!--  -->
        <result column="isuse" property="isuse" />                    <!--  -->
        <result column="menuorder" property="menuorder" />                    <!--  -->
    </resultMap>


    <!-- 시스템관리 > 메뉴관리 > 메뉴 목록 조회 -->
    <select id="selectMenuList" parameterType="com.anylogic.ssystem.bms.com.model.SelectMenuListReqVO" resultMap="selectMenuListMap">
        SELECT
            id as "id"
            , name as "name"
            , type as "type"
            , description as "description"
            , url as "url"
            , isuse as "isuse"
            , inid as "inid"
            , indt as "indt"
            , upid as "upid"
            , updt as "updt"
            , menuorder as "menuorder"
        FROM  sbms.sbms_user.com_menu
        WHERE 1 = 1
            <if test="id != null and id !=''"> 
                and id like CONCAT('%', #{id}, '%') 
            </if>
            <if test="name != null and name !=''"> 
                and name like CONCAT('%', #{name}, '%') 
            </if>
            <if test="type != null and type !=''">
                and type = #{type}
            </if>
        ORDER BY menuorder ASC
    </select>

    <!-- LEFT MENU 조회 - 상위 메뉴 -->
    <select id="selectLeftMenuParent" resultMap="selectLeftMenuParentMap">
        SELECT
            a.id as parentid,
            a.name as parentname,
            a.url as parenturl,
            b.src as icon
        FROM sbms.sbms_user.com_menu a
        INNER JOIN sbms.sbms_user.com_menu_image b ON a.id = b.menuid
        WHERE a.type = 'a'
        ORDER BY a.menuorder ASC
    </select>

    <!--  시스템관리 > 메뉴관리 > 메뉴 삭제 -->
    <delete id="deleteMenuBIA" parameterType="com.anylogic.ssystem.bms.com.model.DeleteMenuBIAReqVO">
        DELETE FROM sbms.sbms_user.com_menu
        WHERE 1 = 1
            and id = #{id}
    </delete>

    <!-- 시스템관리 > 메뉴관리 > 메뉴 상세 조회 -->
    <select id="getMenuDetailBIA" parameterType="com.anylogic.ssystem.bms.com.model.GetMenuDetailBIAReqVO" resultMap="getMenuDetailBIAMap">
        SELECT
            id as "id" 
            , name as "name" 
            , type as "type" 
            , description as "description" 
            , url as "url" 
            , isuse as "isuse"
            , menuorder as "menuorder"
        FROM  sbms.sbms_user.com_menu
        WHERE 1 = 1
            and id = #{id}

    </select>

    <!-- 시스템관리 > 메뉴관리 > 메뉴 등록 -->
    <insert id="insertMenuBIA" parameterType="com.anylogic.ssystem.bms.com.model.InsertMenuBIAReqVO">
        INSERT INTO
        sbms.sbms_user.com_menu(
            <trim suffixOverrides=",">
            <if test="id != null and id !=''">
                id,
            </if>
            <if test="name != null and name !=''">
                name,
            </if>
            <if test="type != null and type !=''">
                type,
            </if>
            <if test="description != null and description !=''">
                description,
            </if>
            <if test="url != null and url !=''">
                url,
            </if>
            <if test="isuse != null and isuse !=''">
                isuse,
            </if>
            <if test="inid != null and inid !=''">
                inid,
            </if>
            <if test="indt != null and indt !=''">
                indt,
            </if>
            <if test="upid != null and upid !=''">
                upid,
            </if>
            <if test="updt != null and updt !=''">
                updt,
            </if>
            <if test="menuorder != null and menuorder !=''">
                menuorder,
            </if>
            </trim>
        )
        VALUES(
            <trim suffixOverrides=",">
            <if test="id != null and id !=''">
                #{id},
            </if>
            <if test="name != null and name !=''">
                #{name},
            </if>
            <if test="type != null and type !=''">
                #{type},
            </if>
            <if test="description != null and description !=''">
                #{description},
            </if>
            <if test="url != null and url !=''">
                #{url},
            </if>
            <if test="isuse != null and isuse !=''">
                #{isuse},
            </if>
            <if test="inid != null and inid !=''">
                #{inid},
            </if>
            <if test="indt != null and indt !=''">
                #{indt},
            </if>
            <if test="upid != null and upid !=''">
                #{upid},
            </if>
            <if test="updt != null and updt !=''">
                #{updt},
            </if>
            <if test="menuorder != null and menuorder !=''">
                #{menuorder},
            </if>
            </trim>
        )
    </insert>

    <!-- 시스템관리 > 메뉴관리 > 메뉴 수정 -->
    <update id="updateMenuBIA" parameterType="com.anylogic.ssystem.bms.com.model.UpdateMenuBIAReqVO">
        UPDATE sbms.sbms_user.com_menu
        <trim prefix="SET" suffixOverrides=",">
            <if test="name != null and name !=''">
                name = #{name},
            </if>
            <if test="type != null and type !=''">
                type = #{type},
            </if>
            <if test="description != null">
                description = #{description},
            </if>
            <if test="url != null and url !=''">
                url = #{url},
            </if>
            <if test="isuse != null and isuse !=''">
                isuse = #{isuse},
            </if>
            <if test="inid != null and inid !=''">
                inid = #{inid},
            </if>
            <if test="indt != null and indt !=''">
                indt = #{indt},
            </if>
            <if test="upid != null and upid !=''">
                upid = #{upid},
            </if>
            <if test="updt != null and updt !=''">
                updt = #{updt},
            </if>
            <if test="menuorder != null and menuorder !=''">
                menuorder = #{menuorder},
            </if>
        </trim>
        WHERE 1 = 1
            and id = #{id}
    </update>

</mapper>

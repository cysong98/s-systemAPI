<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.anylogic.ssystem.bms.com.mapper.ComVgroupUserMapper">

    <resultMap id="selectVgroupUserMap" type="com.anylogic.ssystem.bms.com.model.SelectVgroupUserResVO">
        <id column="vgroupid" property="vgroupid" />                  <!-- 가상그룹아이디 -->
        <result column="userid" property="userid" />                  <!-- 사용자아이디 -->
        <result column="orgid" property="orgid" />                    <!-- 조직아이디 -->
        <result column="vgrouptype" property="vgrouptype" />          <!-- 가상그룹유형 -->
        <result column="inid" property="inid" />                      <!-- 등록자아이디 -->
        <result column="indt" property="indt" />                      <!-- 등록일시 -->
        <result column="upid" property="upid" />                      <!-- 수정자아이디 -->
        <result column="updt" property="updt" />                      <!-- 수정일시 -->
    </resultMap>

    <!-- 사용자 권한 보유 목록 조회 -->
    <select id="selectVgroupUser" parameterType="com.anylogic.ssystem.bms.com.model.SelectVgroupUserReqVO" resultMap="selectVgroupUserMap">
        SELECT
            vgroupid as "vgroupid"
            , userid as "userid"
            , orgid as "orgid"
            , vgrouptype as "vgrouptype"
            , inid as "inid"
            , indt as "indt"
            , upid as "upid"
            , updt as "updt"
        FROM  sbms.sbms_user.com_vgroup_user
        WHERE 1 = 1
            <if test="vgroupid != null and vgroupid !=''">
                and vgroupid = #{vgroupid}
            </if>
            <if test="userid != null and userid !=''">
                and userid = #{userid}
            </if>
            <if test="orgid != null and orgid !=''">
                and orgid = #{orgid}
            </if>
            <if test="vgrouptype != null and vgrouptype !=''">
                and vgrouptype = #{vgrouptype}
            </if>
    </select>

    <!-- 사용자 권한 삭제 -->
    <delete id="deleteUserVgroup" parameterType="com.anylogic.ssystem.bms.com.model.DeleteUserVgroupReqVO">
        DELETE FROM sbms.sbms_user.com_vgroup_user
        WHERE 1 = 1
            <if test="vgroupid != null and vgroupid !=''">
                and vgroupid = #{vgroupid}
            </if>
            and userid = #{userid}
            <if test="orgid != null and orgid !=''">
                and orgid = #{orgid}
            </if>
            <if test="vgroupid != null and vgroupid !=''">
                and vgrouptype = #{vgrouptype}
            </if>
            <choose>
                <when test="delFlag == '5210'">
                    and vgroupid = '5210'
                </when>
                <when test="delFlag == '8015'">
                    and (vgroupid = '8015' or vgroupid = '8010')
                </when>
                <when test="delFlag == '8255'">
                    and (vgroupid = '8255' or vgroupid = '8050')
                </when>
            </choose>
    </delete>

    <!-- 사용자 권한 등록 -->
    <insert id="insertUserVgroup" parameterType="com.anylogic.ssystem.bms.com.model.InsertUserVgroupReqVO">
        INSERT INTO
        sbms.sbms_user.com_vgroup_user(
            <trim suffixOverrides=",">
            <if test="vgroupid != null and vgroupid !=''">
                vgroupid,
            </if>
            <if test="userid != null and userid !=''">
                userid,
            </if>
            <if test="orgid != null and orgid !=''">
                orgid,
            </if>
            <if test="vgrouptype != null and vgrouptype !=''">
                vgrouptype,
            </if>
            <if test="inid != null and inid !=''">
                inid,
            </if>
            <if test="indt != null and indt !=''">
                indt,
            </if>
            <if test="upid != null and upid !=''">
                upid,
            </if>
            <if test="updt != null and updt !=''">
                updt,
            </if>
            </trim>
        )
        VALUES(
            <trim suffixOverrides=",">
            <if test="vgroupid != null and vgroupid !=''">
                #{vgroupid},
            </if>
            <if test="userid != null and userid !=''">
                #{userid},
            </if>
            <if test="orgid != null and orgid !=''">
                #{orgid},
            </if>
            <if test="vgrouptype != null and vgrouptype !=''">
                #{vgrouptype},
            </if>
            <if test="inid != null and inid !=''">
                #{inid},
            </if>
            <if test="indt != null and indt !=''">
                #{indt},
            </if>
            <if test="upid != null and upid !=''">
                #{upid},
            </if>
            <if test="updt != null and updt !=''">
                #{updt},
            </if>
            </trim>
        )
    </insert>

</mapper>
